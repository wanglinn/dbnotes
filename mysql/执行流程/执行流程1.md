# 1. 执行流程
```
mysql: 5.7.26

CREATE TABLE `t1` (
  `id1` int(11) DEFAULT NULL,
  `id2` char(10) DEFAULT NULL,
  KEY `i_t1_id1` (`id1`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4


sql语句：select * from t1; 

-> handle_connection
-> do_command
-> dispatch_command
-> mysql_parse
-> mysql_execute_command
-> execute_sqlcom_select
    ->open_tables_for_query
        ->open_tables
    ->handle_query
        ->st_select_lex::optimize
        ->JOIN::exec
            ->Query_result_send::send_result_set_metadata
            ->do_select
                ->sub_select
                

->sub_select
    ->join_init_read_record
        ->rr_sequential
            ->handler::ha_rnd_next
                ->ha_innobase::rnd_next
                    ->ha_innobase::index_first
                        ->ha_innobase::index_read
                            ->row_search_mvcc
                                ->trx_assign_read_view
                                    ->MVCC::view_open

```
## 1.1 mysql_execute_command

```
(gdb) f 0
#0  mysql_execute_command (thd=0x7ffa240124e0, first_level=true) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:2445
(gdb) p thd->query()
$4 = (const LEX_CSTRING &) @0x7ffa24012700: {str = 0x7ffa2403cf90 "select SQL_NO_CACHE * from t1", length = 29}

(gdb) p lex->sql_command
$41 = SQLCOM_SELECT
(gdb) p lex->query_tables 
$46 = (TABLE_LIST *) 0x7ffa2403dc08
(gdb) p thd->query().str
$49 = 0x7ffa2403cf90 "select SQL_NO_CACHE * from t1"
自带的变量 thd->variables

SELECT_LEX *const select_lex= lex->select_lex;

(gdb) p select_lex
$16 = (SELECT_LEX * const) 0x7ffa2403cfd0
(gdb) p *select_lex
$13 = {
  <Sql_alloc> = {<No data fields>}, 
  members of st_select_lex: 
  _vptr.st_select_lex = 0x2c2a0b0 <vtable for st_select_lex+16>, 
  next = 0x0, 
  prev = 0x7ffa2403d2d0, 
  master = 0x7ffa2403d2b8, 
  slave = 0x0, 
  link_next = 0x0, 
  link_prev = 0x7ffa240148e0, 
  m_query_result = 0x0, 
  m_base_options = 0, 
  m_active_options = 0, 
  sql_cache = st_select_lex::SQL_NO_CACHE,  -- enum e_sql_cache { SQL_CACHE_UNSPECIFIED, SQL_NO_CACHE, SQL_CACHE };
  uncacheable = 0 '\000', 
  linkage = UNSPECIFIED_TYPE, 
  no_table_names_allowed = false, 
  context = {
    <Sql_alloc> = {<No data fields>}, 
    members of Name_resolution_context: 
    outer_context = 0x0, 
    next_context = 0x0, 
    table_list = 0x7ffa2403dc08,   -- 包含库名+表名
    first_name_resolution_table = 0x7ffa2403dc08, 
    last_name_resolution_table = 0x0, 
    select_lex = 0x7ffa2403cfd0,   -- 地址同上
    view_error_handler = false, 
    view_error_handler_arg = 0x0, 
    resolve_in_select_list = true, 
    security_ctx = 0x0
  }, 
  first_context = 0x7ffa2403d030,   -- 这个地址同上面context 相同
  resolve_place = st_select_lex::RESOLVE_NONE, 
  resolve_nest = 0x0, 
  semijoin_disallowed = false, 
  db = 0x0, 
  m_where_cond = 0x0, 
  m_having_cond = 0x0, 
  cond_value = Item::COND_UNDEF, 
  having_value = Item::COND_UNDEF, 
  parent_lex = 0x7ffa24014800,   -- 该select_lex 所属的lex (select_lex= lex->select_lex)
  olap = UNSPECIFIED_OLAP_TYPE, 
  table_list = {                 -- 对应的表列表
    <Sql_alloc> = {<No data fields>}, 
    members of SQL_I_List<TABLE_LIST>: 
    elements = 1, 
    first = 0x7ffa2403dc08, 
    next = 0x7ffa2403dc08
  }, 
  group_list = {                  -- group 操作列表
    <Sql_alloc> = {<No data fields>}, 
    members of SQL_I_List<st_order>: 
    elements = 0, 
    first = 0x0, 
    next = 0x7ffa2403d0f0
  }, 
  group_list_ptrs = 0x0, 
  item_list = {
    <base_list> = {
      <Sql_alloc> = {<No data fields>}, 
      members of base_list: 
      first = 0x7ffa2403da48, 
      last = 0x7ffa2403da48, 
      elements = 1
    }, <No data fields>}, 
  is_item_list_lookup = false, 
  hidden_group_field_count = -1886417009, 
  fields_list = @0x7ffa2403d108, 
  all_fields = {
    <base_list> = {
      <Sql_alloc> = {<No data fields>}, 
      members of base_list: 
      first = 0x2d1c530 <end_of_list>, 
      last = 0x7ffa2403d130, 
      elements = 0
    }, <No data fields>}, 
  ftfunc_list = 0x7ffa2403d150, 
  ftfunc_list_alloc = {
    <base_list> = {
      <Sql_alloc> = {<No data fields>}, 
      members of base_list: 
      first = 0x2d1c530 <end_of_list>, 
      last = 0x7ffa2403d150, 
      elements = 0
    }, <No data fields>}, 
  join = 0x0, 
  top_join_list = {
    <base_list> = {
      <Sql_alloc> = {<No data fields>}, 
      members of base_list: 
      first = 0x7ffa2403e198, 
      last = 0x7ffa2403e198, 
      elements = 1
    }, <No data fields>}, 
  join_list = 0x7ffa2403d170, 
  embedding = 0x0, 
  sj_nests = {
    <base_list> = {
      <Sql_alloc> = {<No data fields>}, 
      members of base_list: 
      first = 0x2d1c530 <end_of_list>, 
      last = 0x7ffa2403d198, 
      elements = 0
    }, <No data fields>}, 
  leaf_tables = 0x0, 
  leaf_table_count = 0, 
  derived_table_count = 0, 
  materialized_derived_table_count = 0, 
  has_sj_nests = false, 
  partitioned_table_count = 0, 
  order_list = {
    <Sql_alloc> = {<No data fields>}, 
    members of SQL_I_List<st_order>: 
    elements = 0, 
    first = 0x0, 
    next = 0x7ffa2403d1d8
  }, 
  order_list_ptrs = 0x0, 
  select_limit = 0x0, 
  offset_limit = 0x0, 
  ref_pointer_array = {
    m_array = 0x0, 
    m_size = 0
  }, 
  ref_ptrs = {
    m_array = 0x0, 
    m_size = 0
  }, 
  select_n_having_items = 1, 
  cond_count = 0, 
  between_count = 0, 
  max_equal_elems = 0, 
  select_n_where_fields = 1, 
  parsing_place = CTX_NONE, 
  in_sum_expr = 0, 
  with_sum_func = false, 
  n_sum_items = 0, 
  n_child_sum_items = 0, 
  select_number = 1, 
  nest_level = 0, 
  inner_sum_func_list = 0x0, 
  with_wild = 1, 
  braces = false, 
  having_fix_field = false, 
  group_fix_field = false, 
  inner_refs_list = {
    <base_list> = {
      <Sql_alloc> = {<No data fields>}, 
      members of base_list: 
      first = 0x2d1c530 <end_of_list>, 
      last = 0x7ffa2403d260, 
      elements = 0
    }, <No data fields>}, 
  explicit_limit = false, 
  subquery_in_having = false, 
  first_execution = true, 
  sj_pullout_done = false, 
  exclude_from_table_unique_test = false, 
  allow_merge_derived = true, 
  prev_join_using = 0x0, 
  select_list_tables = 0, 
  outer_join = 0, 
  opt_hints_qb = 0x0, 
  m_agg_func_used = false, 
  m_json_agg_func_used = false, 
  static type_str = {0x20c4197 "NONE", 0x20c419c "PRIMARY", 0x20c41a4 "SIMPLE", 0x20c41ab "DERIVED", 0x20c41b3 "SUBQUERY", 0x20c41bc "UNION", 
    0x20c41c2 "UNION RESULT", 0x20c41cf "MATERIALIZED"}, 
  sj_candidates = 0x0, 
  hidden_order_field_count = 0
}

```

### 1.1.1 select_lex 成员详解

**select_lex->context**

```
(gdb) p select_lex->context
$8 = {
  <Sql_alloc> = {<No data fields>}, 
  members of Name_resolution_context: 
  outer_context = 0x0, 
  next_context = 0x0, 
  table_list = 0x7ffa2403dc08, 
  first_name_resolution_table = 0x7ffa2403dc08, 
  last_name_resolution_table = 0x0, 
  select_lex = 0x7ffa2403cfd0, 
  view_error_handler = false, 
  view_error_handler_arg = 0x0, 
  resolve_in_select_list = true, 
  security_ctx = 0x0
}

(gdb) p select_lex->context->table_list
$11 = (TABLE_LIST *) 0x7ffa2403dc08
(gdb) p *select_lex->context->table_list
$12 = {
  next_local = 0x0, 
  next_global = 0x0, 
  prev_global = 0x7ffa24014810, 
  db = 0x7ffa2403e190 "db1", 
  table_name = 0x7ffa2403da88 "t1", 
  alias = 0x7ffa2403dc00 "t1", 
  target_tablespace_name = {
    str = 0x0, 
    length = 0
  }, 
  schema_table_name = 0x0, 
  option = 0x0, 
  ...
  lock_type = TL_READ_DEFAULT, 
  outer_join = 0, 
  shared = 0, 
  db_length = 3, 
  table_name_length = 2, 
  m_updatable = false, 
  m_insertable = false, 
  straight = false, 
  updating = false, 
  ...
  join_list = 0x7ffa2403d170, 
  
  ...


(gdb) p *select_lex->context->table_list->join_list
$13 = {
  <base_list> = {
    <Sql_alloc> = {<No data fields>}, 
    members of base_list: 
    first = 0x7ffa2403e198, 
    last = 0x7ffa2403e198, 
    elements = 1
  }, <No data fields>}


```
## 1.2 stmt_causes_implicit_commit
检测语句是否会触发隐式提交  

## 1.3 THD::Query_plan::set_query_plan
```
void THD::Query_plan::set_query_plan(enum_sql_command sql_cmd,
                                     LEX *lex_arg, bool ps)
```

# 2. execute_sqlcom_select

## 2.1 handle_query

保存执行结果  
query_cache.store_query(thd, lex->query_tables);  

st_select_lex::optimize  -- SQL 优化  
      JOIN::optimize (this=0x7fdcac006ca0) at /home/wl/software/mysql-5.7.26/sql/sql_optimizer.cc:268  
         sort_by_table= get_sort_by_table(order, group_list, select_lex->leaf_tables);  -- 表排序  
         bool JOIN::make_join_plan()  
        

## 2.2 make_join_select
```
#0  make_join_select (join=0x7fdcac006ca0, cond=0x0) at /home/wl/software/mysql-5.7.26/sql/sql_optimizer.cc:9123
#1  0x000000000151592f in JOIN::optimize (this=0x7fdcac006ca0) at /home/wl/software/mysql-5.7.26/sql/sql_optimizer.cc:477
#2  0x000000000158cb0a in st_select_lex::optimize (this=0x7fdcac0056d0, thd=0x7fdcac000970) at /home/wl/software/mysql-5.7.26/sql/sql_select.cc:1009
#3  0x000000000158b266 in handle_query (thd=0x7fdcac000970, lex=0x7fdcac002c90, result=0x7fdcac006950, added_options=0, removed_options=0)
    at /home/wl/software/mysql-5.7.26/sql/sql_select.cc:164
#4  0x00000000015410e8 in execute_sqlcom_select (thd=0x7fdcac000970, all_tables=0x7fdcac006308) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:5151
#5  0x000000000153aad9 in mysql_execute_command (thd=0x7fdcac000970, first_level=true) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:2816
#6  0x0000000001541fc3 in mysql_parse (thd=0x7fdcac000970, parser_state=0x7fdcd0165690) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:5577
#7  0x0000000001537a0e in dispatch_command (thd=0x7fdcac000970, com_data=0x7fdcd0165df0, command=COM_QUERY) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:1484
#8  0x0000000001536942 in do_command (thd=0x7fdcac000970) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:1025
#9  0x0000000001666f42 in handle_connection (arg=0x44df560) at /home/wl/software/mysql-5.7.26/sql/conn_handler/connection_handler_per_thread.cc:306
#10 0x0000000001cf22f4 in pfs_spawn_thread (arg=0x461a480) at /home/wl/software/mysql-5.7.26/storage/perfschema/pfs.cc:2190
#11 0x00007fdcd3464dd5 in start_thread () from /lib64/libpthread.so.0
#12 0x00007fdcd212a02d in clone () from /lib64/libc.so.6
```
```
(gdb) f 0
#0  make_join_select (join=0x7fdcac006ca0, cond=0x0) at /home/wl/software/mysql-5.7.26/sql/sql_optimizer.cc:9123
9123      THD *thd= join->thd;
(gdb) p *join
$25 = {
  <Sql_alloc> = {<No data fields>}, 
  members of JOIN: 
  select_lex = 0x7fdcac0056d0, 
  unit = 0x7fdcac0059b8, 
  thd = 0x7fdcac000970, 
  join_tab = 0x0, 
  qep_tab = 0x0, 
  best_ref = 0x7fdcac0071f8, 
  map2table = 0x7fdcac007210, 
  sort_by_table = 0x0, 
  tables = 1, 
  primary_tables = 1, 
  const_tables = 0, 
  tmp_tables = 0, 
  send_group_parts = 0, 
  sort_and_group = false, 
  first_record = false, 
  grouped = false, 
  do_send_rows = true, 
  all_table_map = 1, 
  const_table_map = 0, 
  found_const_table_map = 0, 
  send_records = 0, 
  found_records = 0, 
  examined_rows = 0, 
  row_limit = 18446744073709551615, 
  m_select_limit = 18446744073709551615, 
  fetch_limit = 18446744073709551615, 
  best_positions = 0x0, 
  positions = 0x0, 
  first_select = 0x14f476c <sub_select(JOIN*, QEP_TAB*, bool)>, 
  best_read = 1.7990000000000002, 
  best_rowcount = 4, 
  sort_cost = 0, 
  fields = 0x7fdcac005808,  -- 执行语句对应的列
  group_fields = {
    <base_list> = {
      <Sql_alloc> = {<No data fields>}, 
      members of base_list: 
      first = 0x2d1c530 <end_of_list>, 
      last = 0x7fdcac006d78, 
      elements = 0
    }, <No data fields>}, 
  group_fields_cache = {
    <base_list> = {
      <Sql_alloc> = {<No data fields>}, 
      members of base_list: 
      first = 0x2d1c530 <end_of_list>, 
      last = 0x7fdcac006d90, 
      elements = 0
    }, <No data fields>}, 
  sum_funcs = 0x7fdcac007070,   -- (Item_sum *) 0x0
  sum_funcs_end = 0x7fdcac007078,   -- (Item_sum *) 0x0
  sum_funcs2 = 0x0, 
  sum_funcs_end2 = 0x0, 
  tmp_table_param = {
    <Sql_alloc> = {<No data fields>}, 
    members of Temp_table_param: 
    copy_funcs = {
      <base_list> = {
        <Sql_alloc> = {<No data fields>}, 
        members of base_list: 
        first = 0x2d1c530 <end_of_list>, 
        last = 0x7fdcac006dd0, 
        elements = 0
      }, <No data fields>}, 
    copy_field = 0x0, 
    copy_field_end = 0x0, 
    group_buff = 0x0, 
    items_to_copy = 0x0, 
    recinfo = 0x0, 
    start_recinfo = 0x0, 
    keyinfo = 0x0, 
    end_write_records = 18446744073709551615, 
    field_count = 2, 
    func_count = 0, 
    sum_func_count = 0, 
    hidden_field_count = 0, 
    group_parts = 0, 
    group_length = 0, 
    group_null_parts = 0, 
    quick_group = 1, 
    outer_sum_func_count = 0, 
    using_outer_summary_function = false, 
    table_charset = 0x0, 
    schema_table = false, 
    precomputed_group_by = false, 
    force_copy_fields = false, 
    skip_create_table = false, 
    bit_fields_as_long = false, 
    can_use_pk_for_unique = true
  }, 
  lock = 0x7fdcac032580,  -- 语句对应的锁
  rollup = {
    state = st_rollup::STATE_NONE, 
    null_items = {
      m_array = 0x0, 
      m_size = 0
    }, 
    ref_pointer_arrays = 0x0, 
    fields = 0x0
  }, 
  implicit_grouping = false, 
  select_distinct = false, 
  group_optimized_away = false, 
  simple_order = false, 
  simple_group = false, 
  ordered_index_usage = JOIN::ordered_index_void, 
  no_order = false, 
  skip_sort_order = false, 
  need_tmp = false, 
  keyuse_array = {
    <Mem_root_array_YY<Key_use, true>> = {
      m_root = 0x7fdcac0036a8, 
      m_array = 0x0, 
      m_size = 0, 
      m_capacity = 0
    }, <No data fields>}, 
  all_fields = @0x7fdcac005830, 
  tmp_all_fields1 = {
    <base_list> = {
      <Sql_alloc> = {<No data fields>}, 
      members of base_list: 
      first = 0x2d1c530 <end_of_list>, 
      last = 0x7fdcac006ec8, 
      elements = 0
    }, <No data fields>}, 
  tmp_all_fields2 = {
    <base_list> = {
      <Sql_alloc> = {<No data fields>}, 
      members of base_list: 
      first = 0x2d1c530 <end_of_list>, 
      last = 0x7fdcac006ee0, 
      elements = 0
    }, <No data fields>}, 
  tmp_all_fields3 = {
    <base_list> = {
      <Sql_alloc> = {<No data fields>}, 
      members of base_list: 
      first = 0x2d1c530 <end_of_list>, 
      last = 0x7fdcac006ef8, 
      elements = 0
    }, <No data fields>}, 
  tmp_fields_list1 = {
    <base_list> = {
      <Sql_alloc> = {<No data fields>}, 
      members of base_list: 
      first = 0x2d1c530 <end_of_list>, 
      last = 0x7fdcac006f10, 
      elements = 0
    }, <No data fields>}, 
  tmp_fields_list2 = {
    <base_list> = {
      <Sql_alloc> = {<No data fields>}, 
      members of base_list: 
      first = 0x2d1c530 <end_of_list>, 
      last = 0x7fdcac006f28, 
      elements = 0
    }, <No data fields>}, 
  tmp_fields_list3 = {
    <base_list> = {
      <Sql_alloc> = {<No data fields>}, 
      members of base_list: 
      first = 0x2d1c530 <end_of_list>, 
      last = 0x7fdcac006f40, 
      elements = 0
    }, <No data fields>}, 
  fields_list = @0x7fdcac005808,   -- 表语句对应的列
  error = 0, 
  order = {
    order = 0x0, 
    src = ESC_ORDER_BY, 
    flags = 0
  }, 
  group_list = {
    order = 0x0, 
    src = ESC_GROUP_BY, 
    flags = 0
  }, 
  explain_flags = {
    sorts = "\000\000\000\000"
  }, 
  where_cond = 0x0, 
  having_cond = 0x0, 
  having_for_explain = 0x1, 
  tables_list = 0x7fdcac006308, 
  cond_equal = 0x0, 
  return_tab = 0 '\000', 
  ref_ptrs = {
    m_array = 0x7fdcac006bf8, 
    m_size = 4
  }, 
  items0 = {
    m_array = 0x0, 
    m_size = 0
  }, 
  items1 = {
    m_array = 0x0, 
    m_size = 0
  }, 
  items2 = {
    m_array = 0x0, 
    m_size = 0
  }, 
  items3 = {
    m_array = 0x0, 
    m_size = 0
  }, 
  current_ref_ptrs = {
    m_array = 0x0, 
    m_size = 0
  }, 
  zero_result_cause = 0x0, 
  child_subquery_can_materialize = false, 
  allow_outer_refs = true, 
  sj_tmp_tables = {
    <base_list> = {
      <Sql_alloc> = {<No data fields>}, 
      members of base_list: 
      first = 0x2d1c530 <end_of_list>, 
      last = 0x7fdcac007030, 
      elements = 0
    }, <No data fields>}, 
  sjm_exec_list = {
    <base_list> = {
      <Sql_alloc> = {<No data fields>}, 
      members of base_list: 
      first = 0x2d1c530 <end_of_list>, 
      last = 0x7fdcac007048, 
      elements = 0
    }, <No data fields>}, 
  set_group_rpa = false, 
  group_sent = false, 
  calc_found_rows = false, 
  with_json_agg = false, 
  optimized = true, 
  executed = false, 
  plan_state = JOIN::NO_PLAN
}


上面内容详解
(gdb) p **join->best_ref
$28 = {
  <Sql_alloc> = {<No data fields>}, 
  <QEP_shared_owner> = {
    m_qs = 0x7fdcac007128
  }, 
  members of JOIN_TAB: 
  table_ref = 0x7fdcac006308, 
  m_keyuse = 0x0, 
  m_join_cond_ref = 0x7fdcac006870, 
  cond_equal = 0x0, 
  worst_seeks = 2, 
  const_keys = {
    map = 0
  }, 
  checked_keys = {
    map = 0
  }, 
  needed_reg = {
    map = 0
  }, 
  quick_order_tested = {
    map = 0
  }, 
  found_records = 4, 
  read_time = 1, 
  dependent = 0, 
  key_dependent = 0, 
  used_fieldlength = 0, 
  use_quick = QS_NONE, 
  m_use_join_cache = 0, 
  emb_sj_nest = 0x0, 
  embedding_map = 0, 
  join_cache_flags = 0, 
  reversed_access = false, 
  dodgy_ref_cost = false
}


(gdb) p **join->first_select
$30 = {enum_nested_loop_state (JOIN *, QEP_TAB *, bool)} 0x14f476c <sub_select(JOIN*, QEP_TAB*, bool)>
(gdb) p *join->fields
$32 = {
  <base_list> = {
    <Sql_alloc> = {<No data fields>}, 
    members of base_list: 
    first = 0x7fdcac006148, 
    last = 0x7fdcac006be8, 
    elements = 2
  }, <No data fields>}
  
  
(gdb) p *join->lock->table
$38 = (TABLE *) 0x7fdcac0100a0
(gdb) p *join->lock
$39 = {
  table = 0x7fdcac032598, 
  table_count = 1, 
  lock_count = 0, 
  locks = 0x7fdcac032598
}
(gdb) p *join->lock->locks
$40 = (THR_LOCK_DATA *) 0x7fdcac0100a0
(gdb) p **join->lock->locks
$41 = {
  owner = 0x7fdcac00f260, 
  next = 0x7fdcac010a60, 
  prev = 0x0, 
  lock = 0x7fdcac02b400, 
  cond = 0x0, 
  type = -1409210480, 
  status_param = 0x7fdcac000970, 
  debug_print_param = 0x7fdcac010db0, 
  m_psi = 0x0
}

(gdb) p join->lock->locks->lock
$42 = (st_thr_lock *) 0x7fdcac02b400
(gdb) p *join->lock->locks->lock
$43 = {
  list = {
    prev = 0x7fdcac02a760, 
    next = 0x7fdcac02bdc0, 
    data = 0x7fdcac0184b0
  }, 
  mutex = {
    m_mutex = {
      global = {
        __data = {
          __lock = -1409126512, 
          __count = 32732, 
          __owner = 0, 
          __nusers = 0, 
          __kind = -1409182824, 
          __spins = 32732, 
          __elision = 0, 
          __list = {
            __prev = 0x0, 
            __next = 0x7fdcac02c100
          }
        }, 
        __size = "\220o\002\254\334\177\000\000\000\000\000\000\000\000\000\000\230\223\001\254\334\177", '\000' <repeats 11 times>, "\301\002\254\334\177\000", 
        __align = 140585755373456
      }, 
      mutex = {
        __data = {
          __lock = 0, 
          __count = 0, 
          __owner = -1409105744, 
          __nusers = 32732, 
          __kind = -1409105704, 
          __spins = 32732, 
          __elision = 0, 
          __list = {
            __prev = 0x0, 
            __next = 0x0
          }
        }, 
        __size = "\000\000\000\000\000\000\000\000\260\300\002\254\334\177\000\000\330\300\002\254\334\177", '\000' <repeats 17 times>, 
        __align = 0
      }, 
      file = 0x0, 
      line = 0, 
      count = 0, 
      thread = 0
    }, 
    m_psi = 0x0
  }, 
  read_wait = {
    data = 0x0, 
    last = 0x0
  }, 
  read = {
    data = 0x0, 
    last = 0x0
  }, 
  write_wait = {
    data = 0x0, 
    last = 0x0
  }, 
  write = {
    data = 0x0, 
    last = 0x0
  }, 
  write_lock_count = 0, 
  read_no_write_count = 0, 
  get_status = 0x0, 
  copy_status = 0x0, 
  update_status = 0x0, 
  restore_status = 0x7fdcac028e10, 
  check_status = 0x7fdcac02c0b0
}

```

## 2.3 make_join_select
```
#0  make_join_select (join=0x7fdcac006ca0, cond=0x0) at /home/wl/software/mysql-5.7.26/sql/sql_optimizer.cc:9560
#1  0x000000000151592f in JOIN::optimize (this=0x7fdcac006ca0) at /home/wl/software/mysql-5.7.26/sql/sql_optimizer.cc:477
#2  0x000000000158cb0a in st_select_lex::optimize (this=0x7fdcac0056d0, thd=0x7fdcac000970) at /home/wl/software/mysql-5.7.26/sql/sql_select.cc:1009
#3  0x000000000158b266 in handle_query (thd=0x7fdcac000970, lex=0x7fdcac002c90, result=0x7fdcac006950, added_options=0, removed_options=0)
    at /home/wl/software/mysql-5.7.26/sql/sql_select.cc:164
#4  0x00000000015410e8 in execute_sqlcom_select (thd=0x7fdcac000970, all_tables=0x7fdcac006308) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:5151
#5  0x000000000153aad9 in mysql_execute_command (thd=0x7fdcac000970, first_level=true) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:2816
#6  0x0000000001541fc3 in mysql_parse (thd=0x7fdcac000970, parser_state=0x7fdcd0165690) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:5577
#7  0x0000000001537a0e in dispatch_command (thd=0x7fdcac000970, com_data=0x7fdcd0165df0, command=COM_QUERY) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:1484
#8  0x0000000001536942 in do_command (thd=0x7fdcac000970) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:1025
#9  0x0000000001666f42 in handle_connection (arg=0x44df560) at /home/wl/software/mysql-5.7.26/sql/conn_handler/connection_handler_per_thread.cc:306
#10 0x0000000001cf22f4 in pfs_spawn_thread (arg=0x461a480) at /home/wl/software/mysql-5.7.26/storage/perfschema/pfs.cc:2190
#11 0x00007fdcd3464dd5 in start_thread () from /lib64/libpthread.so.0
#12 0x00007fdcd212a02d in clone () from /lib64/libc.so.6
```

## 2.4 JOIN::exec

### 2.4.1 发送元数据信息 Query_result_send::send_result_set_metadata
```
#0  Protocol_classic::send_field_metadata (this=0x7f9044001d30, field=0x7f906849ef10, item_charset=0x2c96fe0 <my_charset_bin>)
    at /home/wl/software/mysql-5.7.26/sql/protocol_classic.cc:1116
#1  0x00000000014e0fe6 in THD::send_result_metadata (this=0x7f9044000b90, list=0x7f9044005a28, flags=5) at /home/wl/software/mysql-5.7.26/sql/sql_class.cc:4663
#2  0x00000000014db73d in Query_result_send::send_result_set_metadata (this=0x7f9044006b70, list=..., flags=5) at /home/wl/software/mysql-5.7.26/sql/sql_class.cc:2678
#3  0x00000000014f2288 in JOIN::exec (this=0x7f9044006ec0) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:198
#4  0x000000000158b2de in handle_query (thd=0x7f9044000b90, lex=0x7f9044002eb0, result=0x7f9044006b70, added_options=0, removed_options=0)
    at /home/wl/software/mysql-5.7.26/sql/sql_select.cc:184
#5  0x00000000015410e8 in execute_sqlcom_select (thd=0x7f9044000b90, all_tables=0x7f9044006528) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:5151
#6  0x000000000153aad9 in mysql_execute_command (thd=0x7f9044000b90, first_level=true) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:2816
#7  0x0000000001541fc3 in mysql_parse (thd=0x7f9044000b90, parser_state=0x7f90684a0690) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:5577
#8  0x0000000001537a0e in dispatch_command (thd=0x7f9044000b90, com_data=0x7f90684a0df0, command=COM_QUERY) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:1484
#9  0x0000000001536942 in do_command (thd=0x7f9044000b90) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:1025
#10 0x0000000001666f42 in handle_connection (arg=0x3ce9720) at /home/wl/software/mysql-5.7.26/sql/conn_handler/connection_handler_per_thread.cc:306
#11 0x0000000001cf22f4 in pfs_spawn_thread (arg=0x3dbde40) at /home/wl/software/mysql-5.7.26/storage/perfschema/pfs.cc:2190
#12 0x00007f906bdbedd5 in start_thread () from /lib64/libpthread.so.0
#13 0x00007f906aa8402d in clone () from /lib64/libc.so.6
(gdb) 
```

```
(gdb) f 0
#0  Protocol_classic::send_field_metadata (this=0x7f9044001d30, field=0x7f906849ef10, item_charset=0x2c96fe0 <my_charset_bin>)
    at /home/wl/software/mysql-5.7.26/sql/protocol_classic.cc:1116
1116        pos= (char *) packet->ptr() + packet->length();
(gdb) p *field
$21 = {
  <Sql_alloc> = {<No data fields>}, 
  members of Send_field: 
  db_name = 0x7f9044011480 "db1", 
  table_name = 0x7f9044012460 "t1", 
  org_table_name = 0x7f9044011484 "t1", 
  col_name = 0x7f9044006cc8 "id1", 
  org_col_name = 0x7f90440116a9 "id1", 
  length = 11, 
  charsetnr = 8, 
  flags = 16392, 
  decimals = 0, 
  type = MYSQL_TYPE_LONG, 
  field = true
}
```

### 2.4.2 do_select

```
#0  do_select (join=0x7f9044006ec0) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:878
#1  0x00000000014f2297 in JOIN::exec (this=0x7f9044006ec0) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:199
#2  0x000000000158b2de in handle_query (thd=0x7f9044000b90, lex=0x7f9044002eb0, result=0x7f9044006b70, added_options=0, removed_options=0)
    at /home/wl/software/mysql-5.7.26/sql/sql_select.cc:184
#3  0x00000000015410e8 in execute_sqlcom_select (thd=0x7f9044000b90, all_tables=0x7f9044006528) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:5151
#4  0x000000000153aad9 in mysql_execute_command (thd=0x7f9044000b90, first_level=true) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:2816
#5  0x0000000001541fc3 in mysql_parse (thd=0x7f9044000b90, parser_state=0x7f90684a0690) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:5577
#6  0x0000000001537a0e in dispatch_command (thd=0x7f9044000b90, com_data=0x7f90684a0df0, command=COM_QUERY) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:1484
#7  0x0000000001536942 in do_command (thd=0x7f9044000b90) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:1025
#8  0x0000000001666f42 in handle_connection (arg=0x3ce9720) at /home/wl/software/mysql-5.7.26/sql/conn_handler/connection_handler_per_thread.cc:306
#9  0x0000000001cf22f4 in pfs_spawn_thread (arg=0x3dbde40) at /home/wl/software/mysql-5.7.26/storage/perfschema/pfs.cc:2190
#10 0x00007f906bdbedd5 in start_thread () from /lib64/libpthread.so.0
#11 0x00007f906aa8402d in clone () from /lib64/libc.so.6
```
error= join->first_select(join,qep_tab,0);  -- 对应 sub_select  
```
(gdb) f 0
#0  sub_select (join=0x7f9044006ec0, qep_tab=0x7f90440075a0, end_of_records=false) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:1229

READ_RECORD *info
p *info
$50 = {
  table = 0x7f904400e540, 
  forms = 0x0, 
  unlock_row = 0x14600ae <rr_unlock_row(QEP_TAB*)>, 
  read_record = 0x0, 
  thd = 0x0, 
  quick = 0x0, 
  cache_records = 0, 
  ref_length = 0, 
  struct_length = 0, 
  reclength = 0, 
  rec_cache_size = 0, 
  error_offset = 0, 
  unpack_counter = 0, 
  ref_pos = 0x0, 
  record = 0x0,
  rec_buf = 0x0, 
  cache = 0x0, 
  cache_pos = 0x0, 
  cache_end = 0x0, 
  read_positions = 0x0,
  io_cache = 0x0, 
  print_error = false, 
  ignore_not_found_rows = false
}


```

#### 2.4.2.1 sub_select

error= (*qep_tab->read_first_record)(qep_tab);   
-- 对应  sub_select (join=0x7f9044006ec0, qep_tab=0x7f90440075a0, end_of_records=false)   
 at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:1277   

```
#0  init_read_record (info=0x7f90440075f0, thd=0x7f9044000b90, table=0x7f904400e540, qep_tab=0x7f90440075a0, use_record_cache=1, print_error=true, 
    disable_rr_cache=false) at /home/wl/software/mysql-5.7.26/sql/records.cc:317
#1  0x00000000014f77a6 in join_init_read_record (tab=0x7f90440075a0) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:2493
#2  0x00000000014f499d in sub_select (join=0x7f9044006ec0, qep_tab=0x7f90440075a0, end_of_records=false) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:1277
#3  0x00000000014f4330 in do_select (join=0x7f9044006ec0) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:950
#4  0x00000000014f2297 in JOIN::exec (this=0x7f9044006ec0) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:199
#5  0x000000000158b2de in handle_query (thd=0x7f9044000b90, lex=0x7f9044002eb0, result=0x7f9044006b70, added_options=0, removed_options=0)
    at /home/wl/software/mysql-5.7.26/sql/sql_select.cc:184
#6  0x00000000015410e8 in execute_sqlcom_select (thd=0x7f9044000b90, all_tables=0x7f9044006528) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:5151
#7  0x000000000153aad9 in mysql_execute_command (thd=0x7f9044000b90, first_level=true) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:2816
#8  0x0000000001541fc3 in mysql_parse (thd=0x7f9044000b90, parser_state=0x7f90684a0690) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:5577
#9  0x0000000001537a0e in dispatch_command (thd=0x7f9044000b90, com_data=0x7f90684a0df0, command=COM_QUERY) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:1484
#10 0x0000000001536942 in do_command (thd=0x7f9044000b90) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:1025
#11 0x0000000001666f42 in handle_connection (arg=0x3ce9720) at /home/wl/software/mysql-5.7.26/sql/conn_handler/connection_handler_per_thread.cc:306
#12 0x0000000001cf22f4 in pfs_spawn_thread (arg=0x3dbde40) at /home/wl/software/mysql-5.7.26/storage/perfschema/pfs.cc:2190
#13 0x00007f906bdbedd5 in start_thread () from /lib64/libpthread.so.0
#14 0x00007f906aa8402d in clone () from /lib64/libc.so.6


0x00000000014f499d in sub_select (join=0x7fcb80006ec0, qep_tab=0x7fcb800075a0, end_of_records=false) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:1277
if (in_first_read)  1274 行对应
join_init_read_record (tab=0x7fcb800075a0) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:2493



```

```
#0  rr_sequential (info=0x7fcb800075f0) at /home/wl/software/mysql-5.7.26/sql/records.cc:510
#1  0x00000000014f77c6 in join_init_read_record (tab=0x7fcb800075a0) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:2497
#2  0x00000000014f499d in sub_select (join=0x7fcb80006ec0, qep_tab=0x7fcb800075a0, end_of_records=false) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:1277
#3  0x00000000014f4330 in do_select (join=0x7fcb80006ec0) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:950
#4  0x00000000014f2297 in JOIN::exec (this=0x7fcb80006ec0) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:199
#5  0x000000000158b2de in handle_query (thd=0x7fcb80000b90, lex=0x7fcb80002eb0, result=0x7fcb80006b70, added_options=0, removed_options=0)
    at /home/wl/software/mysql-5.7.26/sql/sql_select.cc:184
#6  0x00000000015410e8 in execute_sqlcom_select (thd=0x7fcb80000b90, all_tables=0x7fcb80006528) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:5151
#7  0x000000000153aad9 in mysql_execute_command (thd=0x7fcb80000b90, first_level=true) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:2816
#8  0x0000000001541fc3 in mysql_parse (thd=0x7fcb80000b90, parser_state=0x7fcbace99690) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:5577
#9  0x0000000001537a0e in dispatch_command (thd=0x7fcb80000b90, com_data=0x7fcbace99df0, command=COM_QUERY) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:1484
#10 0x0000000001536942 in do_command (thd=0x7fcb80000b90) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:1025
#11 0x0000000001666f42 in handle_connection (arg=0x4838d70) at /home/wl/software/mysql-5.7.26/sql/conn_handler/connection_handler_per_thread.cc:306
#12 0x0000000001cf22f4 in pfs_spawn_thread (arg=0x4918c80) at /home/wl/software/mysql-5.7.26/storage/perfschema/pfs.cc:2190
```
index

```
(gdb) bt
#0  ha_innobase::index_read (this=0x7fcb80011e90, buf=0x7fcb80012180 "\377", key_ptr=0x0, key_len=0, find_flag=HA_READ_AFTER_KEY)
    at /home/wl/software/mysql-5.7.26/storage/innobase/handler/ha_innodb.cc:8680
#1  0x00000000018cac1a in ha_innobase::index_first (this=0x7fcb80011e90, buf=0x7fcb80012180 "\377")
    at /home/wl/software/mysql-5.7.26/storage/innobase/handler/ha_innodb.cc:9157
#2  0x00000000018cae4b in ha_innobase::rnd_next (this=0x7fcb80011e90, buf=0x7fcb80012180 "\377")
    at /home/wl/software/mysql-5.7.26/storage/innobase/handler/ha_innodb.cc:9255
#3  0x0000000000f32564 in handler::ha_rnd_next (this=0x7fcb80011e90, buf=0x7fcb80012180 "\377") at /home/wl/software/mysql-5.7.26/sql/handler.cc:2955
#4  0x000000000145f608 in rr_sequential (info=0x7fcb800075f0) at /home/wl/software/mysql-5.7.26/sql/records.cc:510
#5  0x00000000014f77c6 in join_init_read_record (tab=0x7fcb800075a0) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:2497
#6  0x00000000014f499d in sub_select (join=0x7fcb80006ec0, qep_tab=0x7fcb800075a0, end_of_records=false) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:1277
#7  0x00000000014f4330 in do_select (join=0x7fcb80006ec0) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:950
#8  0x00000000014f2297 in JOIN::exec (this=0x7fcb80006ec0) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:199
#9  0x000000000158b2de in handle_query (thd=0x7fcb80000b90, lex=0x7fcb80002eb0, result=0x7fcb80006b70, added_options=0, removed_options=0)
    at /home/wl/software/mysql-5.7.26/sql/sql_select.cc:184
#10 0x00000000015410e8 in execute_sqlcom_select (thd=0x7fcb80000b90, all_tables=0x7fcb80006528) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:5151
#11 0x000000000153aad9 in mysql_execute_command (thd=0x7fcb80000b90, first_level=true) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:2816
#12 0x0000000001541fc3 in mysql_parse (thd=0x7fcb80000b90, parser_state=0x7fcbace99690) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:5577
#13 0x0000000001537a0e in dispatch_command (thd=0x7fcb80000b90, com_data=0x7fcbace99df0, command=COM_QUERY) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:1484
#14 0x0000000001536942 in do_command (thd=0x7fcb80000b90) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:1025
#15 0x0000000001666f42 in handle_connection (arg=0x4838d70) at /home/wl/software/mysql-5.7.26/sql/conn_handler/connection_handler_per_thread.cc:306
#16 0x0000000001cf22f4 in pfs_spawn_thread (arg=0x4918c80) at /home/wl/software/mysql-5.7.26/storage/perfschema/pfs.cc:2190
#17 0x00007fcbb07b7dd5 in start_thread () from /lib64/libpthread.so.0
#18 0x00007fcbaf47d02d in clone () from /lib64/libc.so.6

(gdb) p index
$8 = (dict_index_t *) 0x7fcb8001ede0
(gdb) p *index
$9 = {
  id = 41, 
  heap = 0x7fcb80010398, 
  name = {
    m_name = 0x7fcb8001f0e0 "GEN_CLUST_INDEX"
  }, 
  table_name = 0x7fcb8000fa98 "db1/t1", 
  table = 0x7fcb8000f7d0, 
  space = 28, 
  page = 3, 
  merge_threshold = 50, 
  type = 1, 
  trx_id_offset = 6, 
  n_user_defined_cols = 0, 
  allow_duplicates = 0, 
  nulls_equal = 0, 
  disable_ahi = 0, 
  n_uniq = 1, 
  n_def = 5, 
  n_fields = 5, 
  n_nullable = 2, 
  cached = 1, 
  to_be_dropped = 0, 
  online_status = 0, 
  uncommitted = 0, 
  magic_n = 76789786, 
  fields = 0x7fcb8001f0f0, 
  parser = 0x0, 
  is_ngram = false, 
  has_new_v_col = false, 
  index_fts_syncing = false, 
  indexes = {
    prev = 0x0, 
    next = 0x7fcb8001f8c0
  }, 
  search_info = 0x7fcb8001f188, 
  online_log = 0x0, 
  stat_n_diff_key_vals = 0x7fcb8001f170, 
  stat_n_sample_sizes = 0x7fcb8001f178, 
  stat_n_non_null_key_vals = 0x7fcb8001f180, 
  stat_index_size = 1, 
  stat_n_leaf_pages = 1, 
  last_ins_cur = 0x0, 
  last_sel_cur = 0x0, 
  rec_cache = {
    rec_size = 0, 

    offsets = 0x0, 
    sz_of_offsets = 0, 
    fixed_len_key = false, 
    offsets_cached = false, 
    key_has_null_cols = false
  }, 
  rtr_ssn = {
    mutex = {
      m_impl = {
        m_lock_word = 0, 
        m_waiters = 0, 
        m_event = 0x0, 
        m_policy = {
          <MutexDebug<TTASEventMutex<GenericPolicy> >> = {
            _vptr.MutexDebug = 0x0, 
            m_magic_n = 0, 
            m_context = {
              <latch_t> = {
                _vptr.latch_t = 0x0, 
                m_id = LATCH_ID_NONE, 
                m_rw_lock = false, 
                m_temp_fsp = false
              }, 
              members of MutexDebug<TTASEventMutex<GenericPolicy> >::Context: 
              m_mutex = 0x0, 
              m_filename = 0x0, 
              m_line = 0, 
              m_thread_id = 0
            }
          }, 
          members of GenericPolicy<TTASEventMutex<GenericPolicy> >: 
          m_count = {
            m_spins = 0, 
            m_waits = 0, 
            m_calls = 0, 
            m_enabled = false
          }, 
          m_id = LATCH_ID_NONE
        }
      }, 
      m_ptr = 0x0
    }, 
    seq_no = 0
  }, 
  rtr_track = 0x0, 
  trx_id = 0, 

  zip_pad = {
    mutex = 0x0, 
    pad = 0, 
    success = 0, 
    failure = 0, 
    n_rounds = 0, 
    mutex_created = 0
  }, 
  lock = {
    <latch_t> = {
      _vptr.latch_t = 0x2c50470 <vtable for rw_lock_t+16>, 
      m_id = LATCH_ID_INDEX_TREE, 
      m_rw_lock = true, 
      m_temp_fsp = false
    }, 
    members of rw_lock_t: 
    lock_word = 536870912, 
    waiters = 0, 
    recursive = false, 
    sx_recursive = 0, 
    writer_is_wait_ex = false, 
    writer_thread = 0, 
    event = 0x7fcb800102d8, 
    wait_ex_event = 0x7fcb800104a8, 
    cfile_name = 0x22a47b8 "/home/wl/software/mysql-5.7.26/storage/innobase/dict/dict0dict.cc", 
    last_s_file_name = 0x2289390 "/home/wl/software/mysql-5.7.26/storage/innobase/btr/btr0cur.cc", 
    last_x_file_name = 0x226e852 "not yet reserved", 
    cline = 2737, 
    is_block_lock = 0, 
    last_s_line = 2216, 
    last_x_line = 0, 
    count_os_wait = 0, 
    list = {
      prev = 0x7fcb8001fa50, 
      next = 0x40b1e98
    }, 
    pfs_psi = 0x0, 
    magic_n = 22643, 
    debug_list = {
      count = 0, 
      start = 0x0, 
      end = 0x0, 
      node = &rw_lock_debug_t::list, 
      init = 51966
    }, 
    level = SYNC_INDEX_TREE

  }
}
```
**row_search_mvcc**

```
#0  row_search_mvcc (buf=0x7fcb80012180 "\377", mode=PAGE_CUR_G, prebuilt=0x7fcb800166c0, match_mode=0, direction=0)
    at /home/wl/software/mysql-5.7.26/storage/innobase/row/row0sel.cc:4611
#1  0x00000000018c9be4 in ha_innobase::index_read (this=0x7fcb80011e90, buf=0x7fcb80012180 "\377", key_ptr=0x0, key_len=0, find_flag=HA_READ_AFTER_KEY)
    at /home/wl/software/mysql-5.7.26/storage/innobase/handler/ha_innodb.cc:8740
#2  0x00000000018cac1a in ha_innobase::index_first (this=0x7fcb80011e90, buf=0x7fcb80012180 "\377")
    at /home/wl/software/mysql-5.7.26/storage/innobase/handler/ha_innodb.cc:9157
#3  0x00000000018cae4b in ha_innobase::rnd_next (this=0x7fcb80011e90, buf=0x7fcb80012180 "\377")
    at /home/wl/software/mysql-5.7.26/storage/innobase/handler/ha_innodb.cc:9255
#4  0x0000000000f32564 in handler::ha_rnd_next (this=0x7fcb80011e90, buf=0x7fcb80012180 "\377") at /home/wl/software/mysql-5.7.26/sql/handler.cc:2955
#5  0x000000000145f608 in rr_sequential (info=0x7fcb800075f0) at /home/wl/software/mysql-5.7.26/sql/records.cc:510
#6  0x00000000014f77c6 in join_init_read_record (tab=0x7fcb800075a0) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:2497
#7  0x00000000014f499d in sub_select (join=0x7fcb80006ec0, qep_tab=0x7fcb800075a0, end_of_records=false) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:1277
#8  0x00000000014f4330 in do_select (join=0x7fcb80006ec0) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:950
#9  0x00000000014f2297 in JOIN::exec (this=0x7fcb80006ec0) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:199



(gdb) f 5
#5  0x000000000145f608 in rr_sequential (info=0x7fcb800075f0) at /home/wl/software/mysql-5.7.26/sql/records.cc:510
:: 这里进行循环取数据，while ((tmp=info->table->file->ha_rnd_next(info->record)))  




```

**ReadView**
```
(gdb) f 0     
#0  row_search_mvcc (buf=0x7fcb80012180 "\377", mode=PAGE_CUR_G, prebuilt=0x7fcb800166c0, match_mode=0, direction=0)
    at /home/wl/software/mysql-5.7.26/storage/innobase/row/row0sel.cc:4983
(gdb) p trx->read_view
$24 = (ReadView *) 0x476e9d9
(gdb) p *trx->read_view
$26 = {
  m_low_limit_id = 648518346341351479, 
  m_up_limit_id = 55, 
  m_creator_trx_id = 0,
  m_ids = {
    m_ptr = 0x0, 
    m_size = 0,
    m_reserved = 648518346341351424
  }, 
  m_low_limit_no = 72057594037927991, 
  m_closed = false, 
  pad1 = '\000' <repeats 47 times>, 
  m_view_list = {
    prev = 0x0,
    next = 0xa100000000000000
  }
}
```
**clust_index**
```
(gdb) f 0
#0  row_search_mvcc (buf=0x7fcb80012180 "\377", mode=PAGE_CUR_G, prebuilt=0x7fcb800166c0, match_mode=0, direction=0)
    at /home/wl/software/mysql-5.7.26/storage/innobase/row/row0sel.cc:5021
(gdb) p clust_index
$32 = (dict_index_t *) 0x7fcb8001ede0

(gdb)  p *clust_index
$34 = {
  id = 41, 
  heap = 0x7fcb80010398, 
  name = {
    m_name = 0x7fcb8001f0e0 "GEN_CLUST_INDEX"
  }, 
  table_name = 0x7fcb8000fa98 "db1/t1", 
  table = 0x7fcb8000f7d0, 
  space = 28, 
  page = 3, 
  merge_threshold = 50, 
  type = 1, 
  trx_id_offset = 6, 
  n_user_defined_cols = 0, 
  allow_duplicates = 0, 
  nulls_equal = 0, 
  disable_ahi = 0, 
  n_uniq = 1, 
  n_def = 5, 
  n_fields = 5, 
  n_nullable = 2, 
  cached = 1, 
  to_be_dropped = 0, 
  online_status = 0, 
  uncommitted = 0, 
  magic_n = 76789786, 
  fields = 0x7fcb8001f0f0, 
  parser = 0x0, 
  is_ngram = false, 
  has_new_v_col = false, 
  index_fts_syncing = false, 
  indexes = {
    prev = 0x0, 
    next = 0x7fcb8001f8c0
  }, 
  search_info = 0x7fcb8001f188, 
  online_log = 0x0, 
  stat_n_diff_key_vals = 0x7fcb8001f170, 
  stat_n_sample_sizes = 0x7fcb8001f178, 
  stat_n_non_null_key_vals = 0x7fcb8001f180, 
  stat_index_size = 1, 
  stat_n_leaf_pages = 1, 
  last_ins_cur = 0x0, 
  last_sel_cur = 0x0, 
  rec_cache = {
    rec_size = 0, 

    offsets = 0x0, 
    sz_of_offsets = 0, 
    fixed_len_key = false, 
    offsets_cached = false, 
    key_has_null_cols = false
  }, 
  rtr_ssn = {
    mutex = {
      m_impl = {
        m_lock_word = 0, 
        m_waiters = 0, 
        m_event = 0x0, 
        m_policy = {
          <MutexDebug<TTASEventMutex<GenericPolicy> >> = {
            _vptr.MutexDebug = 0x0, 
            m_magic_n = 0, 
            m_context = {
              <latch_t> = {
                _vptr.latch_t = 0x0, 
                m_id = LATCH_ID_NONE, 
                m_rw_lock = false, 
                m_temp_fsp = false
              }, 
              members of MutexDebug<TTASEventMutex<GenericPolicy> >::Context: 
              m_mutex = 0x0, 
              m_filename = 0x0, 
              m_line = 0, 
              m_thread_id = 0
            }
          }, 
          members of GenericPolicy<TTASEventMutex<GenericPolicy> >: 
          m_count = {
            m_spins = 0, 
            m_waits = 0, 
            m_calls = 0, 
            m_enabled = false
          }, 
          m_id = LATCH_ID_NONE
        }
      }, 
      m_ptr = 0x0
    }, 
    seq_no = 0
  }, 
  rtr_track = 0x0, 
  trx_id = 0, 

  zip_pad = {
    mutex = 0x0, 
    pad = 0, 
    success = 0, 
    failure = 0, 
    n_rounds = 0, 
    mutex_created = 0
  }, 
  lock = {
    <latch_t> = {
      _vptr.latch_t = 0x2c50470 <vtable for rw_lock_t+16>, 
      m_id = LATCH_ID_INDEX_TREE, 
      m_rw_lock = true, 
      m_temp_fsp = false
    }, 
    members of rw_lock_t: 
    lock_word = 536870912, 
    waiters = 0, 
    recursive = false, 
    sx_recursive = 0, 
    writer_is_wait_ex = false, 
    writer_thread = 0, 
    event = 0x7fcb800102d8, 
    wait_ex_event = 0x7fcb800104a8, 
    cfile_name = 0x22a47b8 "/home/wl/software/mysql-5.7.26/storage/innobase/dict/dict0dict.cc", 
    last_s_file_name = 0x2289390 "/home/wl/software/mysql-5.7.26/storage/innobase/btr/btr0cur.cc", 
    last_x_file_name = 0x226e852 "not yet reserved", 
    cline = 2737, 
    is_block_lock = 0, 
    last_s_line = 2216, 
    last_x_line = 0, 
    count_os_wait = 0, 
    list = {
      prev = 0x7fcb8001fa50, 
      next = 0x40b1e98
    }, 
    pfs_psi = 0x0, 
    magic_n = 22643, 
    debug_list = {
      count = 0, 
      start = 0x0, 
      end = 0x0, 
      node = &rw_lock_debug_t::list, 
      init = 51966
    }, 
    level = SYNC_INDEX_TREE

  }
}


(gdb) p view->m_low_limit_id
$41 = 14089
(gdb) p trx_sys_get_max_trx_id()
$42 = 14089
(gdb) f 0
#0  MVCC::view_open (this=0x4744828, view=@0x7fcbad756960: 0x476e9d8, trx=0x7fcbad7568c0) at /home/wl/software/mysql-5.7.26/storage/innobase/read/read0read.cc:572

(gdb) bt
#0  MVCC::view_open (this=0x4744828, view=@0x7fcbad756960: 0x476e9d8, trx=0x7fcbad7568c0) at /home/wl/software/mysql-5.7.26/storage/innobase/read/read0read.cc:572
#1  0x0000000001ae8dee in trx_assign_read_view (trx=0x7fcbad7568c0) at /home/wl/software/mysql-5.7.26/storage/innobase/trx/trx0trx.cc:2269
#2  0x0000000001a58a9b in row_search_mvcc (buf=0x7fcb80012180 "\377", mode=PAGE_CUR_G, prebuilt=0x7fcb800166c0, match_mode=0, direction=0)
    at /home/wl/software/mysql-5.7.26/storage/innobase/row/row0sel.cc:5040
#3  0x00000000018c9be4 in ha_innobase::index_read (this=0x7fcb80011e90, buf=0x7fcb80012180 "\377", key_ptr=0x0, key_len=0, find_flag=HA_READ_AFTER_KEY)
    at /home/wl/software/mysql-5.7.26/storage/innobase/handler/ha_innodb.cc:8740
#4  0x00000000018cac1a in ha_innobase::index_first (this=0x7fcb80011e90, buf=0x7fcb80012180 "\377")
    at /home/wl/software/mysql-5.7.26/storage/innobase/handler/ha_innodb.cc:9157
#5  0x00000000018cae4b in ha_innobase::rnd_next (this=0x7fcb80011e90, buf=0x7fcb80012180 "\377")
    at /home/wl/software/mysql-5.7.26/storage/innobase/handler/ha_innodb.cc:9255
#6  0x0000000000f32564 in handler::ha_rnd_next (this=0x7fcb80011e90, buf=0x7fcb80012180 "\377") at /home/wl/software/mysql-5.7.26/sql/handler.cc:2955
#7  0x000000000145f608 in rr_sequential (info=0x7fcb800075f0) at /home/wl/software/mysql-5.7.26/sql/records.cc:510
#8  0x00000000014f77c6 in join_init_read_record (tab=0x7fcb800075a0) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:2497
#9  0x00000000014f499d in sub_select (join=0x7fcb80006ec0, qep_tab=0x7fcb800075a0, end_of_records=false) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:1277
#10 0x00000000014f4330 in do_select (join=0x7fcb80006ec0) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:950
#11 0x00000000014f2297 in JOIN::exec (this=0x7fcb80006ec0) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:199
#12 0x000000000158b2de in handle_query (thd=0x7fcb80000b90, lex=0x7fcb80002eb0, result=0x7fcb80006b70, added_options=0, removed_options=0)
    at /home/wl/software/mysql-5.7.26/sql/sql_select.cc:184
#13 0x00000000015410e8 in execute_sqlcom_select (thd=0x7fcb80000b90, all_tables=0x7fcb80006528) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:5151
#14 0x000000000153aad9 in mysql_execute_command (thd=0x7fcb80000b90, first_level=true) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:2816
#15 0x0000000001541fc3 in mysql_parse (thd=0x7fcb80000b90, parser_state=0x7fcbace99690) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:5577
#16 0x0000000001537a0e in dispatch_command (thd=0x7fcb80000b90, com_data=0x7fcbace99df0, command=COM_QUERY) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:1484
#17 0x0000000001536942 in do_command (thd=0x7fcb80000b90) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:1025
#18 0x0000000001666f42 in handle_connection (arg=0x4838d70) at /home/wl/software/mysql-5.7.26/sql/conn_handler/connection_handler_per_thread.cc:306
#19 0x0000000001cf22f4 in pfs_spawn_thread (arg=0x4918c80) at /home/wl/software/mysql-5.7.26/storage/perfschema/pfs.cc:2190
#20 0x00007fcbb07b7dd5 in start_thread () from /lib64/libpthread.so.0
#21 0x00007fcbaf47d02d in clone () from /lib64/libc.so.6


读取下一个页内容  

#0  btr_pcur_move_to_next_on_page (cursor=0x7fcb800168d8) at /home/wl/software/mysql-5.7.26/storage/innobase/include/btr0pcur.ic:263
#1  0x0000000001a4e304 in btr_pcur_move_to_next (cursor=0x7fcb800168d8, mtr=0x7fcbace971c0) at /home/wl/software/mysql-5.7.26/storage/innobase/include/btr0pcur.ic:365
#2  0x0000000001a5b15a in row_search_mvcc (buf=0x7fcb80012180 "\377", mode=PAGE_CUR_G, prebuilt=0x7fcb800166c0, match_mode=0, direction=0)
    at /home/wl/software/mysql-5.7.26/storage/innobase/row/row0sel.cc:6107
#3  0x00000000018c9be4 in ha_innobase::index_read (this=0x7fcb80011e90, buf=0x7fcb80012180 "\377", key_ptr=0x0, key_len=0, find_flag=HA_READ_AFTER_KEY)
    at /home/wl/software/mysql-5.7.26/storage/innobase/handler/ha_innodb.cc:8740
#4  0x00000000018cac1a in ha_innobase::index_first (this=0x7fcb80011e90, buf=0x7fcb80012180 "\377")
    at /home/wl/software/mysql-5.7.26/storage/innobase/handler/ha_innodb.cc:9157
#5  0x00000000018cae4b in ha_innobase::rnd_next (this=0x7fcb80011e90, buf=0x7fcb80012180 "\377")
    at /home/wl/software/mysql-5.7.26/storage/innobase/handler/ha_innodb.cc:9255
#6  0x0000000000f32564 in handler::ha_rnd_next (this=0x7fcb80011e90, buf=0x7fcb80012180 "\377") at /home/wl/software/mysql-5.7.26/sql/handler.cc:2955
#7  0x000000000145f608 in rr_sequential (info=0x7fcb800075f0) at /home/wl/software/mysql-5.7.26/sql/records.cc:510
#8  0x00000000014f77c6 in join_init_read_record (tab=0x7fcb800075a0) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:2497
#9  0x00000000014f499d in sub_select (join=0x7fcb80006ec0, qep_tab=0x7fcb800075a0, end_of_records=false) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:1277


(gdb) p btr_cur
$53 = (const btr_cur_t *) 0x7fcb800168d8
(gdb) p *btr_cur
$54 = {
  index = 0x7fcb8001ede0, 
  page_cur = {
    index = 0x0, 
    rec = 0x7fcba444c07f "", 
    offsets = 0x0, 
    block = 0x7fcba3d0e3f8
  }, 
  purge_node = 0x0, 
  left_block = 0x0, 
  thr = 0x0, 
  flag = 0, 
  tree_height = 0, 
  up_match = 0,
  up_bytes = 0,
  low_match = 0, 
  low_bytes = 0, 
  n_fields = 0,
  n_bytes = 0, 
  fold = 0, 
  path_arr = 0x0, 
  rtr_info = 0x0
}
(gdb)

(gdb) f 0
#0  rec_get_next_offs (rec=0x7fcba444c07f "", comp=1) at /home/wl/software/mysql-5.7.26/storage/innobase/include/rem0rec.ic:345
(gdb) f 1
#1  0x0000000001a59427 in row_search_mvcc (buf=0x7fcb80012180 "\377", mode=PAGE_CUR_G, prebuilt=0x7fcb800166c0, match_mode=0, direction=0)
    at /home/wl/software/mysql-5.7.26/storage/innobase/row/row0sel.cc:5290

mtr_commit(&mtr);
```


# 3. 查看使用索引

```
如果select * from t1 where id1 =1;

0x00000000014f499d in sub_select (join=0x7f4c54007508, qep_tab=0x7f4c5412a3f0, end_of_records=false) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:1277 
函数中:
while (rc == NESTED_LOOP_OK && join->return_tab >= qep_tab_idx)
{
  int error;
  if (in_first_read)
  {
     in_first_read= false; 
	 error= (*qep_tab->read_first_record)(qep_tab); 
      -- 使用索引对应 join_read_always_key， 不使用索引 join_init_read_record,再到 rr_sequential
  }
  else
    error= info->read_record(info);  -- 对应 join_read_next_same， 不使用索引 rr_sequential
}
(gdb) f 1
#1  0x00000000014f499d in sub_select (join=0x7f4c54007508, qep_tab=0x7f4c5412a3f0, end_of_records=false) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:1277
(gdb) f 0
#0  join_read_always_key (tab=0x7f4c5412a3f0) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:2273


handler::ha_index_read_map

```
# 3.1 index_read

```
(gdb) bt
#0  ha_innobase::index_read (this=0x7f4c5400f810, buf=0x7f4c5400fb00 "\371\001", key_ptr=0x7f4c5412a2f0 "", key_len=5, find_flag=HA_READ_KEY_EXACT)
    at /home/wl/software/mysql-5.7.26/storage/innobase/handler/ha_innodb.cc:8656
#1  0x0000000000f40c82 in handler::index_read_map (this=0x7f4c5400f810, buf=0x7f4c5400fb00 "\371\001", key=0x7f4c5412a2f0 "", keypart_map=1, 
    find_flag=HA_READ_KEY_EXACT) at /home/wl/software/mysql-5.7.26/sql/handler.h:2809
#2  0x0000000000f32bbf in handler::ha_index_read_map (this=0x7f4c5400f810, buf=0x7f4c5400fb00 "\371\001", key=0x7f4c5412a2f0 "", keypart_map=1, 
    find_flag=HA_READ_KEY_EXACT) at /home/wl/software/mysql-5.7.26/sql/handler.cc:3039
#3  0x00000000014f6ee5 in join_read_always_key (tab=0x7f4c5412a3f0) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:2275
#4  0x00000000014f499d in sub_select (join=0x7f4c54007508, qep_tab=0x7f4c5412a3f0, end_of_records=false) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:1277
#5  0x00000000014f4330 in do_select (join=0x7f4c54007508) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:950
#6  0x00000000014f2297 in JOIN::exec (this=0x7f4c54007508) at /home/wl/software/mysql-5.7.26/sql/sql_executor.cc:199
#7  0x000000000158b2de in handle_query (thd=0x7f4c54000e00, lex=0x7f4c54003120, result=0x7f4c54007190, added_options=0, removed_options=0)
    at /home/wl/software/mysql-5.7.26/sql/sql_select.cc:184
#8  0x00000000015410e8 in execute_sqlcom_select (thd=0x7f4c54000e00, all_tables=0x7f4c54006888) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:5151
#9  0x000000000153aad9 in mysql_execute_command (thd=0x7f4c54000e00, first_level=true) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:2816
#10 0x0000000001541fc3 in mysql_parse (thd=0x7f4c54000e00, parser_state=0x7f4c7a117690) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:5577
#11 0x0000000001537a0e in dispatch_command (thd=0x7f4c54000e00, com_data=0x7f4c7a117df0, command=COM_QUERY) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:1484
#12 0x0000000001536942 in do_command (thd=0x7f4c54000e00) at /home/wl/software/mysql-5.7.26/sql/sql_parse.cc:1025
#13 0x0000000001666f42 in handle_connection (arg=0x4e912c0) at /home/wl/software/mysql-5.7.26/sql/conn_handler/connection_handler_per_thread.cc:306
#14 0x0000000001cf22f4 in pfs_spawn_thread (arg=0x4eaa6a0) at /home/wl/software/mysql-5.7.26/storage/perfschema/pfs.cc:2190
#15 0x00007f4c7da77dd5 in start_thread () from /lib64/libpthread.so.0
#16 0x00007f4c7c73d02d in clone () from /lib64/libc.so.6
(gdb) p index
$50 = (dict_index_t *) 0x7f4c4c01f8c0
(gdb) p *infex
No symbol "infex" in current context.
(gdb) p *index
$51 = {
  id = 44, 
  heap = 0x7f4c4c01f728, 
  name = {
    m_name = 0x7f4c4c01fbc0 "i_t1_id1"
  }, 
  table_name = 0x7f4c4c00fa98 "db1/t1", 
  table = 0x7f4c4c00f7d0, 
  space = 28, 
  page = 4, 
  merge_threshold = 50, 
  type = 0, 
  trx_id_offset = 0, 
  n_user_defined_cols = 1, 
  allow_duplicates = 0, 
  nulls_equal = 0, 
  disable_ahi = 0, 
  n_uniq = 2, 
  n_def = 2, 
  n_fields = 2, 
  n_nullable = 1, 
  cached = 1, 
  to_be_dropped = 0, 
  online_status = 0, 
  uncommitted = 0, 
  magic_n = 76789786, 
  fields = 0x7f4c4c01fbd0, 
  parser = 0x0, 
  is_ngram = false, 
  has_new_v_col = false, 
  index_fts_syncing = false, 
  indexes = {
    prev = 0x7f4c4c01ede0, 
    next = 0x0
  }, 
  search_info = 0x7f4c4c01fc50, 
  online_log = 0x0, 
  stat_n_diff_key_vals = 0x7f4c4c01fc20, 
  stat_n_sample_sizes = 0x7f4c4c01fc30, 
  stat_n_non_null_key_vals = 0x7f4c4c01fc40, 
  stat_index_size = 1, 
  stat_n_leaf_pages = 1, 
  last_ins_cur = 0x0, 
  last_sel_cur = 0x0, 
  rec_cache = {
    rec_size = 0, 

    offsets = 0x0, 
    sz_of_offsets = 0, 
    fixed_len_key = false, 
    offsets_cached = false, 
    key_has_null_cols = false
  }, 
  rtr_ssn = {
    mutex = {
      m_impl = {
        m_lock_word = 0, 
        m_waiters = 0, 
        m_event = 0x0, 
        m_policy = {
          <MutexDebug<TTASEventMutex<GenericPolicy> >> = {
            _vptr.MutexDebug = 0x0, 
            m_magic_n = 0, 
            m_context = {
              <latch_t> = {
                _vptr.latch_t = 0x0, 
                m_id = LATCH_ID_NONE, 
                m_rw_lock = false, 
                m_temp_fsp = false
              }, 
              members of MutexDebug<TTASEventMutex<GenericPolicy> >::Context: 
              m_mutex = 0x0, 
              m_filename = 0x0, 
              m_line = 0, 
              m_thread_id = 0
            }
          }, 
          members of GenericPolicy<TTASEventMutex<GenericPolicy> >: 
          m_count = {
            m_spins = 0, 
            m_waits = 0, 
            m_calls = 0, 
            m_enabled = false
          }, 
          m_id = LATCH_ID_NONE
        }
      }, 
      m_ptr = 0x0
    }, 
    seq_no = 0
  }, 
  rtr_track = 0x0, 
  trx_id = 0, 

  zip_pad = {
    mutex = 0x0, 
    pad = 0, 
    success = 0, 
    failure = 0, 
    n_rounds = 0, 
    mutex_created = 0
  }, 
  lock = {
    <latch_t> = {
      _vptr.latch_t = 0x2c50470 <vtable for rw_lock_t+16>, 
      m_id = LATCH_ID_INDEX_TREE, 
      m_rw_lock = true, 
      m_temp_fsp = false
    }, 
    members of rw_lock_t: 
    lock_word = 536870912, 
    waiters = 0, 
    recursive = false, 
    sx_recursive = 0, 
    writer_is_wait_ex = false, 
    writer_thread = 0, 
    event = 0x7f4c4c0201a8, 
    wait_ex_event = 0x7f4c4c020248, 
    cfile_name = 0x22a47b8 "/home/wl/software/mysql-5.7.26/storage/innobase/dict/dict0dict.cc", 
    last_s_file_name = 0x2289390 "/home/wl/software/mysql-5.7.26/storage/innobase/btr/btr0cur.cc", 
    last_x_file_name = 0x226e852 "not yet reserved", 
    cline = 2737, 
    is_block_lock = 0, 
    last_s_line = 1008, 
    last_x_line = 0, 
    count_os_wait = 0, 
    list = {
      prev = 0x7f4c4c0101c8, 
      next = 0x7f4c4c01ef70
    }, 
    pfs_psi = 0x0, 
    magic_n = 22643, 
    debug_list = {
      count = 0, 
      start = 0x0, 
      end = 0x0, 
      node = &rw_lock_debug_t::list, 
      init = 51966
    }, 
    level = SYNC_INDEX_TREE

  }
}
(gdb) 
```

